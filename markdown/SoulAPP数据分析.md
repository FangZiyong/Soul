# SoulAPP数据分析总结

## 数据获取

利用Python的requests库从SoulAPP的数据接口获取数据，主要用了其中两个接口：

* 获取用户主页信息的链接[**https://api.soulapp.cn/html/user/getUserInfo?userId=用户ID**](https://api.soulapp.cn/html/user/getUserInfo?userId=)

* 获取单条瞬间的链接[**https://api.soulapp.cn/html/post/detail?id=瞬间ID**](https://api.soulapp.cn/html/post/detail?id=)

两个接口均会返回一个json数据，格式如下

```json
{
    "code":10001,
    "message":"获取成功！",
    "data":null,
    "success":true
}
```

其中有相当数量的用户ID返回的主页数据的data为null，为无效数据，为了保证数据整齐划一，在数据获取过程中全部以json形式存入MySQL数据库，由于用户主页返回数据中并不包含用户ID，所以将用户ID作为pandas库中的的DataFrame的index，写入到数据库时也将index写入，后续处理过程中将其视为用户ID。

由于从网页获取数据速度较慢，单进程每秒约可获取8-9条数据，效率太低，采用多进程，两台电脑同时获取数据，前前后后包括爬取，处理各种错误，共用了大概十多天，获取了四千万条左右的用户主页数据，一亿条左右瞬间信息。

## 数据认知

分别以用户和瞬间为中心整理出下图所示数据。

两个图。

## 以用户为中心的分析。

### 用户注册

首先SoulAPP自2015年7月8日以来的日用户注册量的变化图和累计用户量变化图。

两个图。

单从拉新用户量来看，SoulAPP是一款做得极为出色的应用，到目前为止用户量几乎都是呈现指数增长。

### 从年龄角度分析SoulAPP用户

**单从以上SoulAPP用户年龄可以得到如下信息：**

1. 首先在1970年和1991年出现了异常，1970年可能和计算机元年相关，而1991年可能和注册时的默认生日有关。如果1991年确实为默认生日所导致，那么SoulAPP可以优化注册的默认生日时间。
2. 用户大致呈现以1998年为中心的偏态分布，其中左边较为平缓，右边较为陡峭，视觉上呈现左偏，然而计算偏度却发现偏度大于零，说明该分布右偏，造成此现象的原因是在2007年之后有大量极低值，使得理论上的偏度和视觉上的偏度出现了截然相反的情况，在这种情况下我们应该根据业务需求取舍，以SoulAPP为例，SoulAPP主要关注青年，而2007年出生的人群今年才12岁，不属于SoulAPP的目标人群，故即使他们的存在让偏度为正，也不应该去关注这一部分人群，更应该关注视觉上的左偏。  

值得注意的是，这里仅仅展示了注册用户的年龄，然而注册不代表活跃，活跃不代表付费。由于拿不到更详细的用户活跃与付费数据，这里无法做进一步的活跃以及付费分析。如果能拿到可能会考虑到各种用户阶段的与年龄的相关关系，可以探究的关联有很多，在此不一一展开。

**关于用户年龄与注册时间的进一步分析。从另一个角度分析SoulAPP的用户扩展策略。**

以用户注册时间（日）为横轴，以用户注册时填写的生日（日）为纵坐标，以颜色代表注册人数，可得一张热图。由于数据量较大，约有四百多万条，Jupyter中暂时没有找到能够较好的绘制这种热图的工具，故将此图用Tableau绘制后发布到Tableau Pubilic，需要查看请点击链接：[注册时间、出生时间注册人数分布热图](https://public.tableau.com/profile/ziyongfang#!/vizhome/10186/1)。

从图中我们又能发现很多信息。

1. 整体来看，SoulAPP在这几年一直在拓宽不同年龄的人群，从最开始仅针对1995年左右出生的人群，到2017年十月拓宽到90后，到2018年二月拓展到1987年之后出生的人群，2018年七月开始两头并进，既向年龄稍大用户推广，又向2005年之后出生的较低年龄用户推广。此后一直向年龄更大的用户推广，至2019年三月左右，推广到80后左右。
2. 无论什么时候，SoulAPP的核心用户总是20岁左右的青年，因此未来注册时间与用户生日的热图将逐渐趋于稳定。

### 用户邮箱

SoulAPP推出绑定邮箱的推出Soul币的活动，故部分用户会填写自己的邮箱，如此一来Soul后续可通过邮件的方式找回流失客户。简单统计Soul用户绑定的邮箱种类。

邮箱种类饼图。 

可以看到qq邮箱一骑绝尘，占据了88.0%的份额，163邮箱和gmail是除了qq邮箱之外仅有的两个占比超过%1的邮箱，分别占比5.1%和4.5%，其他种类邮箱占比均未超过1%。

### 用户发布的瞬间数目

在研究用户发布瞬间的数目与用户数之间的关系的时候，我的思维大致经过了这样一个过程。

1. 作用户数-用户瞬间数的条形图，发现随着瞬间条数的增加，相应的用户数目急剧下降，自然而然想到对用户数目取对数。
2. 取对数之后发现二者关系近似成一个反比关系，但用反比拟合效果并不是很好，会有一个明显偏差。
3. 观察发现图形比较像一个对数函数图像的x轴轴对称图形，经过一番推导，最终选择利用$\lg y=a\lg x+b$来拟合二者关系。分别以用户发布瞬间数目和用户数目的以10为底的对数作图如下。

可以看到这个公式是很好的反映了二者之间的关系的。在动态数目极多的情况下（超过一千条），该公式并未能很好地拟合，原因在于发布动态超过一千条的用户仅占极少数，偶然性较强，因此会出现误差，也是可以接受的。

后来读到一本关于推荐系统的书籍时才发现，这个规律已经被哈佛大学的语言学家Zipf在研究英文单词的词频时发现了，他发现将单词的词频按照从高到低排列，每个单词出现的频率和他们在排行榜中的排名的常数次幂成反比，这一定律也就命名为Zipf定律。而在互联网中，这个分布也被称为长尾分布，可以写为：
$$
f(x)=\alpha x^k
$$
上面的公式本质上和我之前提出的$\lg y=a\lg x+b$是相同的，稍加变形即可互相推导出。

这种理论应该是可以在SoulAPP上得到推广的，以下几种关系应该也是符合这种长尾分布的：

1. 用户发布的瞬间的被喜欢的次数，与对应的瞬间数目，但是这里也有一些干扰因素，即SoulAPP的推荐算法。
2. 用户发布的瞬间获得的评论数目，与对应的瞬间数目。
3. 用户在线时长也是用户活跃度的另一种表现方式，也应该符合长尾分布。
4. 涉及到各个话题的瞬间数目和其排名也应该符合长尾分布。

总的来说，长尾分布是一种热度排名和热度衡量指数的关系，另一个很好例子就是电子商务商品的受欢迎程度排名和与该商品发生过关系的用户数目。

## 以瞬间为中心的分析

社交软件可以根据用户之间的关联性分为几类。

1. 用户之间关联度极高，大部分为现实中也认识的朋友，进行较多私密性交流，以QQ，微信，Facebook为代表。
2. 用户之间关联度较低，使用该软件的目的为了解名人动态、官方发布，以及表达自我，以微博，twitter为代表。
3. 用户之间关联度极低，用户以结交网友，希望在无人认识自己的地方表达自己，以及婚恋，以陌陌，探探，SoulAPP为代表。

上文提到了瞬间被喜欢的次数与对应的瞬间的数目的关系，下面对其做一个验证。

正如预期的一样，瞬间评论数目与对应的瞬间数目呈现长尾分布。

首先，这个分布大体上是符合长尾分布的，但是中间这一段实在是太吊诡了，除了人为控制，还没有找到能够很好的解释这个现象的理论。有待后续进一步研究。

### 瞬间的可视化

由于部分瞬间包含了经纬度，因此我只做了一个关于SoulAPP的瞬间地理可视化，将对应的瞬间标记到了地图上，标记类型区分瞬间的类型，颜色代表不同的评论数目，标记大小代表了喜欢的数目。[SoulAPP瞬间可视化链接](https://public.tableau.com/profile/ziyongfang#!/vizhome/10219/1)。

## 更多

这个数据集其实还有非常多值得研究的问题，但是限于自己的笔记本性能，只在这里提出我的想法，如果以后有机会再来做这些分析。最后将我能想到的可以继续研究的问题列出来：

1. 获取的数据中，主页数据包含了用户ID，而瞬间数据也包含了作者ID，可对二者join（不知道MySQL里面的这个操作怎么翻译），然后利用用户否是的瞬间对各个用户进行个性化分析。
2. 利用1.中的用户数据分析用户性格，进一步提高用户分类的效果，毕竟在SoulAPP中确实有用户来自不同星球的功能。
3. 瞬间数据中的评论包含了每个评论者的userIdEcpt，虽然不知道最后的Ecpt代表了什么意思，但是这应该是一个用户身份唯一标识符，于是，不仅可以提取每个用户的历史瞬间记录，甚至可以提取出用户所有的评论信息，如此又可以对用户进一步分析。
4. 可以根据瞬间中的用户互动探究用户之间的社交网络。

# 希望自己能进SoulAPP工作吧！